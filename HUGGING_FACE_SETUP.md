# Hugging Face API Integration Setup Guide

This document outlines how to set up the Hugging Face API integration for AI-powered itinerary generation in ZipTrip.

## ‚úÖ What's Been Done

The following changes have been implemented:

### Backend Updates (`/server`)

1. **Updated `src/controllers/itineraryController.js`**
   - Added `generateItinerary()` function that calls Hugging Face API
   - Uses the free `rahmanazhar/Travereel-Model-V1` model
   - Handles prompt generation with detailed itinerary parameters
   - Includes error handling and logging

2. **Updated `src/routes/itineraryRoutes.js`**
   - Added POST `/api/itineraries/generate` endpoint
   - Protected with Clerk authentication middleware
   - Routes to the new `generateItinerary` controller

3. **Updated `example.env`**
   - Added `HF_TOKEN` placeholder for Hugging Face API key

### Frontend Updates (`/src`)

1. **Updated `components/planning/ItineraryView.tsx`**
   - Added `generateAIItinerary()` function to call backend
   - Integrated "AI Regenerate" button in the actions section
   - Shows loading state while generating
   - Displays AI-generated itinerary to user

## üöÄ Setup Instructions

### Step 1: Get Your Hugging Face API Token

1. Visit [https://huggingface.co/settings/tokens](https://huggingface.co/settings/tokens)
2. Sign up or log in to your Hugging Face account (free)
3. Click "New token"
4. Give it a name (e.g., "ZipTrip")
5. Select "Read" access level
6. Copy the token

### Step 2: Configure Your Backend

1. In `/server`, create a `.env` file (or update the existing one):

```env
PORT=5000
MONGODB_URI=mongodb://localhost:27017/wanderwise
JWT_SECRET=super-secret-change-me
CLIENT_URL=http://localhost:5173
CLERK_PUBLISHABLE_KEY=pk_test_xxx
CLERK_SECRET_KEY=sk_test_xxx
HF_TOKEN=hf_your_token_here
```

Replace `hf_your_token_here` with your actual Hugging Face token.

### Step 3: Start Your Backend

```bash
cd server
npm install  # If not already done
npm run dev  # Starts on port 5000
```

### Step 4: Configure Your Frontend (Optional)

If your backend runs on a different URL, update the environment:

Create or update `/.env` in the root directory:
```env
VITE_API_URL=http://localhost:5000
```

### Step 5: Test the Integration

1. Start your frontend: `npm run dev`
2. Navigate to the trip planning page
3. Complete all steps to reach the "Itinerary" step
4. Click the "AI Regenerate" button
5. A detailed AI-generated itinerary should appear in a popup

## üìù API Endpoint Details

### POST `/api/itineraries/generate`

**Protected**: Requires Clerk authentication

**Request Body**:
```json
{
  "destination": "Paris",
  "days": 3
}
```

**Response**:
```json
{
  "itinerary": "Detailed itinerary text generated by Hugging Face model..."
}
```

**Error Response**:
```json
{
  "error": "Failed to generate itinerary",
  "details": "API error message"
}
```

## üîß How It Works

1. **User clicks "AI Regenerate"** ‚Üí Frontend sends destination and number of days to backend
2. **Backend receives request** ‚Üí Creates a detailed prompt for the Hugging Face API
3. **Hugging Face API** ‚Üí Processes the prompt using the Travereel-Model-V1 and returns generated text
4. **Backend returns response** ‚Üí Sends the generated itinerary text to frontend
5. **Frontend displays result** ‚Üí Shows the AI-generated itinerary in an alert/modal

## üí° Key Features

- ‚úÖ **Free Model**: Uses Hugging Face's free inference API
- ‚úÖ **No Local Models**: No need to download large model files
- ‚úÖ **Fast**: Inference is handled by Hugging Face servers
- ‚úÖ **Secure**: API token stored in backend environment variables
- ‚úÖ **Scalable**: Can handle multiple concurrent requests
- ‚úÖ **Authenticated**: Only logged-in users can generate itineraries

## üêõ Troubleshooting

### "Failed to generate itinerary" Error

**Solution**: Check the following:
1. Is your `HF_TOKEN` correct in `.env`?
2. Is the Hugging Face API status up? Check [huggingface.co/status](https://huggingface.co/status)
3. Is your backend running on port 5000?

### CORS Error

**Solution**: Ensure your `CLIENT_URL` in backend `.env` matches your frontend URL.

### Model Not Found

**Solution**: The free Travereel-Model-V1 might be temporarily unavailable. You can:
1. Check the model at [huggingface.co/rahmanazhar/Travereel-Model-V1](https://huggingface.co/rahmanazhar/Travereel-Model-V1)
2. Swap it for another travel-focused model like `mistral-community/Mistral-7B-Instruct-v0.2`

## üìö Additional Resources

- [Hugging Face Documentation](https://huggingface.co/docs)
- [Hugging Face Inference API](https://huggingface.co/docs/api-inference)
- [Clerk Authentication](https://clerk.com/docs)

## üéØ Next Steps

1. **Parse AI Response**: Currently shows raw text. Consider parsing it into structured itinerary format
2. **User Feedback**: Add ability for users to rate/refine AI suggestions
3. **Custom Models**: Later, train your own travel planning model
4. **Caching**: Cache generated itineraries to reduce API costs
5. **Multi-language**: Generate itineraries in different languages

---

**Last Updated**: December 11, 2025
**Status**: ‚úÖ Ready to Use
